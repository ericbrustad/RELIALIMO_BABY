<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Display Test - RELIALIMO</title>
    <link rel="stylesheet" href="global.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e3f2fd;
        }
        
        .test-header h1 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .explanation {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #4caf50;
        }
        
        .explanation h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }
        
        .explanation ul {
            margin-left: 20px;
        }
        
        .explanation li {
            margin-bottom: 5px;
        }
        
        #vehicleTable table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        #vehicleTable th,
        #vehicleTable td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        #vehicleTable th {
            background: #1976d2;
            color: white;
            font-weight: bold;
        }
        
        #vehicleTable tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        #vehicleTable tr:hover {
            background: #e3f2fd;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #fff;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .demo-section {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        
        .demo-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .dropdown-demo {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .dropdown-demo select {
            min-width: 300px;
            padding: 8px;
            font-size: 14px;
        }
        
        .assigned-display {
            font-weight: bold;
            color: #1565c0;
            padding: 8px 12px;
            background: #e3f2fd;
            border-radius: 4px;
            border-left: 4px solid #1976d2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header class="test-header">
            <h1>ðŸš— Vehicle Display Test - Assign Driver to Car</h1>
            <p>This page demonstrates the updated vehicle display format using <code>veh_title</code> and <code>license_plate</code> from fleet_vehicles.</p>
        </header>
        
        <div class="explanation">
            <h3>Display Format Rules:</h3>
            <ul>
                <li><strong>Primary Format:</strong> <code>veh_title [license_plate]</code> (when both available)</li>
                <li><strong>Title Only:</strong> <code>veh_title</code> (when license_plate is empty)</li>
                <li><strong>Plate Only:</strong> <code>Vehicle [license_plate]</code> (when veh_title is empty)</li>
                <li><strong>Fallback:</strong> <code>unit_number</code> or <code>make model year</code> (when both title and plate are empty)</li>
                <li><strong>Inactive:</strong> Same format with <code>(Inactive)</code> suffix</li>
            </ul>
            <p><strong>Location:</strong> Office â†’ Drivers â†’ Assign Driver to Car dropdown and bold display</p>
        </div>
        
        <div class="demo-section">
            <h3>Live Demo - How it looks in the interface:</h3>
            <div class="dropdown-demo">
                <div>
                    <label>Assign Driver to Car:</label>
                    <select id="demoDropdown">
                        <option value="">- Not Assigned -</option>
                    </select>
                </div>
                <div>
                    <div id="demoDisplay" class="assigned-display" style="display: none;">
                        ðŸš— <span id="demoDisplayText"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="vehicleTable">
            <!-- Vehicle table will be populated here -->
        </div>
        
        <div id="consoleOutput" class="console-output">
            Console output will appear here...
        </div>
    </div>
    
    <script src="test-vehicle-display.js"></script>
    <script>
        // Populate the demo dropdown
        function populateDemo() {
            const select = document.getElementById('demoDropdown');
            const display = document.getElementById('demoDisplay');
            const displayText = document.getElementById('demoDisplayText');
            
            // Clear existing options
            select.innerHTML = '<option value="">- Not Assigned -</option>';
            
            // Add test vehicles to dropdown (same as mock data)
            const testVehicles = [
                { id: '1', veh_title: 'Executive Sedan', license_plate: 'ABC-123' },
                { id: '2', veh_title: 'Luxury SUV', license_plate: 'XYZ-789' },
                { id: '3', veh_title: '', license_plate: 'DEF-456' },
                { id: '4', veh_title: 'Town Car', license_plate: '' },
                { id: '5', veh_title: '', license_plate: '', unit_number: 'UNIT-005' }
            ];
            
            testVehicles.forEach(vehicle => {
                const option = document.createElement('option');
                option.value = vehicle.id;
                
                // Apply same logic as my-office.js
                const vehTitle = vehicle.veh_title || '';
                const licensePlate = vehicle.license_plate || '';
                
                let displayText = '';
                if (vehTitle && licensePlate) {
                    displayText = `${vehTitle} [${licensePlate}]`;
                } else if (vehTitle) {
                    displayText = vehTitle;
                } else if (licensePlate) {
                    displayText = `Vehicle [${licensePlate}]`;
                } else {
                    displayText = vehicle.unit_number || `Vehicle ${vehicle.id}`;
                }
                
                option.textContent = displayText;
                select.appendChild(option);
            });
            
            // Add change listener
            select.addEventListener('change', (e) => {
                if (e.target.value) {
                    const selectedOption = e.target.options[e.target.selectedIndex];
                    displayText.textContent = selectedOption.textContent;
                    display.style.display = 'block';
                } else {
                    display.style.display = 'none';
                }
            });
        }
        
        function runTest() {
            // Capture console output
            const originalLog = console.log;
            let consoleOutput = '';
            
            console.log = function(...args) {
                consoleOutput += args.join(' ') + '\n';
                originalLog.apply(console, args);
            };
            
            // Run the test
            testVehicleDisplay();
            
            // Restore console.log
            console.log = originalLog;
            
            // Display output
            document.getElementById('consoleOutput').textContent = consoleOutput;
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            populateDemo();
            runTest();
        });
    </script>
</body>
</html>