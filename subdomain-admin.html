<!DOCTYPE html>
<html lang="en" data-layout="vertical">
  <head>
    <script>
      // Auto-redirect based on subdomain
      (function() {
        const hostname = window.location.hostname;
        
        // If we're on admin.relialimo.com and not on the root path, serve admin content
        if (hostname === 'admin.relialimo.com') {
          // We're on the admin subdomain, show admin content
          console.log('Admin subdomain detected, loading admin interface');
        } else if (hostname === 'relialimo.com' && window.location.pathname === '/') {
          // We're on main domain root, redirect to landing
          window.location.replace('/landing.html');
          return;
        }
        
        // Apply saved layout mode early to avoid flash
        const savedLayout = localStorage.getItem('headerLayout') || 'vertical';
        document.documentElement.setAttribute('data-layout', savedLayout);
        
        // Check for startup page preference
        try {
          var s = localStorage.getItem('company_settings');
          if (s) {
            var p = JSON.parse(s).defaultStartPage;
            var r = {'new-reservation':'reservation-form.html','farmout-dashboard':'dashboard.html','office':'my-office.html','accounts':'accounts.html','calendar':'calendar.html','quotes':'quotes.html','dispatch':'dispatch-grid.html','network':'network.html','settle':'settle.html','receivables':'receivables.html','payables':'payables.html','memos':'memos.html','files':'files.html','tools':'tools.html','reports':'reports.html'};
            if (r[p] && window.location.pathname.indexOf(r[p]) === -1 && hostname === 'admin.relialimo.com') {
              window.location.replace(r[p]);
              return;
            }
          }
        } catch(e) {
          console.error('Startup script failed:', e);
        }
        
        document.documentElement.style.visibility = 'visible';
      })();
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RELIALIMOâ„¢ - Admin Portal</title>
    <link rel="icon" href="https://relialimo.com/favicon.png" />
    <!-- Load environment variables first -->
    <script src="https://relialimo.com/env.js"></script>
    <script type="module" src="https://relialimo.com/auth-guard.js"></script>
    <script type="module" src="https://relialimo.com/user-menu.js"></script>
    <script type="module" src="https://relialimo.com/CompanySettingsManager.js"></script>
    <script type="module" src="https://relialimo.com/SettingsApplicationManager.js"></script>
    <link rel="stylesheet" href="https://relialimo.com/my-office.css" />
    <link rel="stylesheet" href="https://relialimo.com/accounts.css" />
    <link rel="stylesheet" href="https://relialimo.com/quotes.css" />
    <link rel="stylesheet" href="https://relialimo.com/calendar.css" />
    <link rel="stylesheet" href="https://relialimo.com/user-menu.css" />
    <style>
      :root {
        --sidebar-width: 170px;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        background: #f5f6fa;
      }
      #app {
        display: flex;
        height: 100vh;
        width: 100%;
      }
      .app-main-section {
        display: none;
        width: 100%;
        min-height: calc(100vh - 0px);
      }
      .app-main-section.active {
        display: block;
      }
      
      .auto-farmout-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #ff6b6b;
        color: white;
        font-size: 10px;
        padding: 2px 4px;
        border-radius: 50%;
        min-width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
      }

      .status-indicator {
        background: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.2);
        padding: 4px 8px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 10px;
        display: flex;
        align-items: center;
        gap: 4px;
        transition: background 0.2s;
        margin: 2px 0;
        color: rgba(255,255,255,0.8);
      }
      .status-indicator:hover {
        background: rgba(255,255,255,0.15);
      }
      .status-indicator .status-dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: #ff4757;
      }
      .status-indicator.configured .status-dot {
        background: #2ed573;
      }
      .status-indicator.partial .status-dot {
        background: #ffa502;
      }
      .status-indicator.not-configured .status-dot {
        background: #ff4757;
      }
      .system-status-bar {
        margin-top: auto;
        padding: 8px;
        border-top: 1px solid rgba(255,255,255,0.1);
        display: flex;
        gap: 4px;
      }
      .header-right-section {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .global-search-container {
        position: relative;
        display: flex;
        align-items: center;
      }
      .global-search-toggle {
        background: rgba(255,255,255,0.15);
        border: 1px solid rgba(255,255,255,0.3);
        color: white;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }
      .global-search-toggle:hover {
        background: rgba(255,255,255,0.25);
      }
      .global-search-toggle.active {
        background: white;
        color: #667eea;
      }
      .global-search-box {
        position: absolute;
        top: 100%;
        right: 0;
        width: 350px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        display: none;
        z-index: 9999;
        margin-top: 8px;
      }
      .global-search-box.active {
        display: block;
      }
      .global-search-input {
        width: 100%;
        padding: 12px 16px;
        border: none;
        border-bottom: 1px solid #eee;
        font-size: 14px;
        outline: none;
        border-radius: 8px 8px 0 0;
      }
      .global-search-results {
        max-height: 400px;
        overflow-y: auto;
      }
      .search-result-item {
        padding: 10px 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        border-bottom: 1px solid #f0f0f0;
      }
      .search-result-item:hover {
        background: #f5f5f5;
      }
      .search-result-item .result-icon {
        font-size: 16px;
        width: 24px;
        text-align: center;
      }
      .search-result-item .result-text {
        flex: 1;
      }
      .search-result-item .result-title {
        font-weight: 600;
        color: #333;
      }
      .search-result-item .result-section {
        font-size: 11px;
        color: #888;
      }
      .search-no-results {
        padding: 20px;
        text-align: center;
        color: #888;
      }
      html[data-layout="vertical"] .global-search-container {
        margin-top: 10px;
      }
      html[data-layout="vertical"] .global-search-box {
        left: 100%;
        right: auto;
        top: 0;
        margin-left: 8px;
        margin-top: 0;
      }
      
      html[data-layout="vertical"] .system-status-bar {
        flex-direction: column;
        border-top: 1px solid rgba(255,255,255,0.1);
        margin-top: 10px;
      }
      html[data-layout="horizontal"] .system-status-bar {
        flex-direction: row;
      }

      /* VERTICAL layout styles */
      html[data-layout="vertical"] body {
        margin: 0;
        padding: 0;
      }
      html[data-layout="vertical"] #app {
        display: flex;
        flex-direction: row;
        height: 100vh;
        width: 100%;
      }
      html[data-layout="vertical"] #app > header.header {
        position: fixed;
        top: 0;
        left: 0;
        width: var(--sidebar-width);
        height: 100vh;
        padding: 12px;
        box-sizing: border-box;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        box-shadow: 4px 0 20px rgba(0,0,0,0.15);
        z-index: 1000;
        overflow-y: auto;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
      }
      html[data-layout="vertical"] #app > header.header .header-content {
        display: flex;
        flex-direction: column;
        gap: 8px;
        height: 100%;
      }

      html[data-layout="vertical"] #app > header.header .main-nav {
        display: flex;
        flex-direction: column;
        gap: 4px;
        flex: 1;
        overflow-y: auto;
        padding-right: 2px;
      }
      html[data-layout="vertical"] #app > header.header .main-nav::-webkit-scrollbar {
        width: 4px;
      }
      html[data-layout="vertical"] #app > header.header .main-nav::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.1);
        border-radius: 2px;
      }
      html[data-layout="vertical"] #app > header.header .main-nav::-webkit-scrollbar-thumb {
        background: rgba(255,255,255,0.3);
        border-radius: 2px;
      }
      html[data-layout="vertical"] #app > header.header .main-nav::-webkit-scrollbar-thumb:hover {
        background: rgba(255,255,255,0.35);
      }

      html[data-layout="vertical"] #app > header.header .nav-btn {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 10px;
        border: 1px solid rgba(255,255,255,0.1);
        background: rgba(255,255,255,0.05);
        color: white;
        cursor: pointer;
        font-size: 11px;
        font-weight: 600;
        border-radius: 6px;
        transition: background 0.15s ease, transform 0.05s ease;
      }

      html[data-layout="vertical"] #app > header.header .nav-btn:hover {
        background: rgba(255,255,255,0.12);
        transform: translateX(2px);
      }

      html[data-layout="vertical"] #app > header.header .nav-btn.active {
        background: #e74c3c;
        border-color: #e74c3c;
      }

      html[data-layout="vertical"] #app > header.header .logo {
        font-size: 16px;
        font-weight: 800;
        color: white;
        display: flex;
        align-items: center;
        gap: 6px;
        margin: 0;
        text-align: center;
      }

      html[data-layout="vertical"] .app-main-section {
        padding: 12px;
        width: calc(100% - var(--sidebar-width)) !important;
        box-sizing: border-box;
      }

      /* Guard against global .header styles from iframes/other pages */
      #app > header.header {
        box-sizing: border-box;
      }

      /* Horizontal layout (original) */
      html[data-layout="horizontal"] body {
        padding: 0;
      }

      html[data-layout="horizontal"] #app > header.header {
        position: relative;
        width: 100%;
        display: block;
        background: #1f2a44;
        color: white;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      }

      html[data-layout="horizontal"] #app > header.header .header-content {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 10px 16px;
      }

      html[data-layout="horizontal"] #app > header.header .main-nav {
        display: flex;
        flex-direction: row;
        gap: 6px;
        flex: 1;
        flex-wrap: wrap;
      }

      html[data-layout="horizontal"] #app > header.header .nav-btn {
        display: inline-flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 12px;
        border: 1px solid rgba(255,255,255,0.1);
        background: rgba(255,255,255,0.05);
        color: white;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        border-radius: 6px;
        transition: background 0.15s ease, transform 0.05s ease;
      }

      html[data-layout="horizontal"] #app > header.header .nav-btn:hover {
        background: rgba(255,255,255,0.12);
        transform: translateY(-1px);
      }

      html[data-layout="horizontal"] #app > header.header .nav-btn.active {
        background: #e74c3c;
        border-color: #e74c3c;
      }

      html[data-layout="horizontal"] #app > header.header .logo {
        font-size: 18px;
        font-weight: 800;
        color: white;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      html[data-layout="horizontal"] .app-main-section {
        padding: 20px;
        margin-left: 0 !important;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <header class="header">
        <div class="header-content">
          <h1 class="logo">
            <img src="https://siumiadylwcrkaqsfwkj.supabase.co/storage/v1/object/public/images/reliabull_Trans.png" alt="RELIALIMO" style="height: 144px; width: auto;">
          </h1>
          
          <div class="main-nav">
            <button class="nav-btn" data-section="new-reservation"><span>New Reservation</span><span style="font-size: 24px;">â•</span></button>
            <button class="nav-btn" data-section="dashboard"><span>Farmout Dashboard</span><span style="font-size: 24px;">ğŸ </span></button>
            <button class="nav-btn active" data-section="office"><span>Office</span><span style="font-size: 24px;">ğŸ¢</span></button>
            <button class="nav-btn" data-section="accounts"><span>Accounts</span><span style="font-size: 24px;">ğŸ‘¤</span></button>
            <button class="nav-btn" data-section="calendar"><span>Calendar</span><span style="font-size: 24px;">ğŸ“…</span></button>
            <button class="nav-btn" data-section="quotes"><span>Quotes</span><span style="font-size: 24px;">ğŸ“‹</span></button>
            <button class="nav-btn" data-section="reservations"><span>Reservations</span><span style="font-size: 24px;">ğŸš—</span></button>
            <button class="nav-btn" data-section="dispatch"><span>Dispatch</span><span style="font-size: 24px;">ğŸš™</span></button>
            <button class="nav-btn" data-section="network"><span>Network</span><span style="font-size: 24px;">ğŸŒ</span></button>
            <button class="nav-btn" data-section="settle"><span>Settle</span><span style="font-size: 24px;">ğŸ’°</span></button>
            <button class="nav-btn" data-section="receivables"><span>Receivables</span><span style="font-size: 24px;">ğŸ“Š</span></button>
            <button class="nav-btn" data-section="payables"><span>Payables</span><span style="font-size: 24px;">ğŸ’³</span></button>
            <button class="nav-btn" data-section="memos"><span>Memos</span><span style="font-size: 24px;">ğŸ“</span></button>
            <button class="nav-btn" data-section="files"><span>Files</span><span style="font-size: 24px;">ğŸ“</span></button>
            <button class="nav-btn" data-section="tools"><span>Tools</span><span style="font-size: 24px;">ğŸ”§</span></button>
            <button class="nav-btn" data-section="reports"><span>Reports</span><span style="font-size: 24px;">ğŸ“ˆ</span></button>
          </div>

          <div class="header-right-section">
            <div class="global-search-container">
              <button class="global-search-toggle" onclick="toggleGlobalSearch()">ğŸ”</button>
              <div class="global-search-box" id="globalSearchBox">
                <input type="text" class="global-search-input" id="globalSearchInput" placeholder="Search sections, accounts, reservations..." onkeydown="handleSearchKeydown(event)" oninput="performGlobalSearch()">
                <div class="global-search-results" id="globalSearchResults"></div>
              </div>
            </div>
            <div id="userMenuContainer"></div>
          </div>

          <div class="system-status-bar">
            <div id="smsStatusIndicator" class="status-indicator not-configured" onclick="navigateToSmsSettings()" title="Click to configure SMS settings">
              <span class="status-dot"></span><span>SMS: Not Set</span>
            </div>
            <div id="emailStatusIndicator" class="status-indicator not-configured" onclick="navigateToEmailSettings()" title="Click to configure Email settings">
              <span class="status-dot"></span><span>Email: Not Set</span>
            </div>
          </div>
        </div>
      </header>

      <!-- OFFICE SECTION -->
      <div id="officeSection" class="app-main-section active" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/my-office.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- ACCOUNTS SECTION -->
      <div id="accountsSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/accounts.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- CALENDAR SECTION -->
      <div id="calendarSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/calendar.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- QUOTES SECTION -->
      <div id="quotesSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/quotes.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- RESERVATIONS SECTION -->
      <div id="reservationsSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/reservations-list.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- DISPATCH SECTION -->
      <div id="dispatchSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/dispatch-grid.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- DASHBOARD SECTION -->
      <div id="dashboardSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/dashboard.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- NETWORK SECTION -->
      <div id="networkSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/network.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- SETTLE SECTION -->
      <div id="settleSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/settle.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- RECEIVABLES SECTION -->
      <div id="receivablesSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/receivables.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- PAYABLES SECTION -->
      <div id="payablesSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/payables.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- MEMOS SECTION -->
      <div id="memosSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/memos.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- FILES SECTION -->
      <div id="filesSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/files.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- TOOLS SECTION -->
      <div id="toolsSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/tools.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- REPORTS SECTION -->
      <div id="reportsSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/reports.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- NEW RESERVATION SECTION -->
      <div id="new-reservationSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/reservation-form.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>

      <!-- CONFIRMED RESERVATION SECTION (VIEW MODE) -->
      <div id="confirmedReservationSection" class="app-main-section" style="margin-left: var(--sidebar-width);">
        <iframe src="https://relialimo.com/confirmed-reservation.html" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
      </div>
    </div>

    <script src="https://relialimo.com/admin-functionality.js"></script>
  </body>
</html>